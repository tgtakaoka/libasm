# Ninja build script for libasm/driver/test

root = ../..
cxxflags = -std=c++14 -Wall -O ${debug_flags}
cppflags = -I${root}/driver -I${root}/src -I${root}/test

rule cxx
  depfile = ${out}.d
  command = g++ ${cxxflags} ${cppflags} -MD -MF ${out}.d -c ${in} -o ${out}

rule test
  command = g++ ${cxxflags} ${in} -o ${out} && ./${out}

subninja ${root}/driver/ninja.rules
subninja ${root}/driver/test/ninja.rules
subninja ${root}/src/ninja.rules
subninja ${root}/test/ninja.rules

build test_helpers:      test test_helpers.o bin_memory.o $
  test_driver_helper.o test_asserter.o error_reporter.o str_scanner.o

build test_bin_memory:   test test_bin_memory.o bin_memory.o $
  test_driver_helper.o test_asserter.o error_reporter.o str_scanner.o

build test_intel_hex:    test test_intel_hex.o bin_memory.o $
  bin_decoder.o bin_encoder.o intel_hex.o moto_srec.o $
  test_driver_helper.o test_asserter.o error_reporter.o str_scanner.o

build test_moto_srec:    test test_moto_srec.o bin_memory.o $
  bin_decoder.o bin_encoder.o intel_hex.o moto_srec.o $
  test_driver_helper.o test_asserter.o error_reporter.o str_scanner.o

build test_asm_formatter: test test_asm_formatter.o test_driver_helper.o test_asserter.o $
  list_formatter.o asm_formatter.o asm_driver.o asm_directive.o function_store.o $
  bin_memory.o bin_encoder.o bin_decoder.o intel_hex.o moto_srec.o $
  asm_base.o config_base.o error_reporter.o value_formatter.o value_parser.o parsers.o $
  operators.o option_base.o str_buffer.o str_scanner.o $
  asm_mc6809.o asm_mc6800.o asm_mc6805.o asm_mos6502.o asm_i8048.o asm_i8051.o $
  asm_i8080.o asm_i8096.o asm_z80.o asm_z8.o asm_tlcs90.o asm_ins8060.o asm_ins8070.o $
  asm_cdp1802.o asm_scn2650.o asm_f3850.o asm_i8086.o asm_tms9900.o asm_tms32010.o asm_mc68000.o $
  asm_z8000.o asm_ns32000.o asm_mn1610.o $
  reg_mc6809.o reg_mc6800.o reg_mc6805.o reg_mos6502.o reg_i8048.o reg_i8051.o reg_i8080.o $
  reg_i8096.o reg_z80.o reg_z8.o reg_tlcs90.o reg_ins8060.o reg_ins8070.o reg_cdp1802.o $
  reg_scn2650.o reg_f3850.o reg_i8086.o reg_tms9900.o reg_tms32010.o reg_mc68000.o reg_z8000.o $
  reg_ns32000.o reg_mn1610.o $
  table_mc6809.o table_mc6800.o table_mc6805.o table_mos6502.o table_i8048.o table_i8051.o $
  table_i8080.o table_i8096.o table_z80.o table_z8.o table_tlcs90.o table_ins8060.o $
  table_ins8070.o table_cdp1802.o table_scn2650.o table_f3850.o table_i8086.o table_tms9900.o $
  table_tms32010.o table_mc68000.o table_z8000.o table_ns32000.o table_mn1610.o $
  text_common.o text_mc6809.o text_mc6800.o text_mc6805.o text_mos6502.o text_i8048.o $
  text_i8051.o text_i8080.o text_i8096.o text_z80.o text_z8.o text_tlcs90.o text_ins8060.o $
  text_ins8070.o text_cdp1802.o text_scn2650.o text_f3850.o text_i8086.o text_tms9900.o $
  text_tms32010.o text_mc68000.o text_z8000.o text_ns32000.o text_mn1610.o

build test_dis_formatter: test test_dis_formatter.o test_driver_helper.o test_asserter.o $
  list_formatter.o dis_formatter.o dis_driver.o function_store.o bin_memory.o bin_encoder.o $
  bin_decoder.o intel_hex.o moto_srec.o $
  dis_base.o config_base.o error_reporter.o value_formatter.o value_parser.o parsers.o $
  operators.o option_base.o str_buffer.o str_scanner.o $
  dis_mc6809.o dis_mc6800.o dis_mc6805.o dis_mos6502.o dis_i8048.o dis_i8051.o $
  dis_i8080.o dis_i8096.o dis_z80.o dis_z8.o dis_tlcs90.o dis_ins8060.o dis_ins8070.o $
  dis_cdp1802.o dis_scn2650.o dis_f3850.o dis_i8086.o dis_tms9900.o dis_tms32010.o dis_mc68000.o $
  dis_z8000.o dis_ns32000.o dis_mn1610.o $
  reg_mc6809.o reg_mc6800.o reg_mc6805.o reg_mos6502.o reg_i8048.o reg_i8051.o reg_i8080.o $
  reg_i8096.o reg_z80.o reg_z8.o reg_tlcs90.o reg_ins8060.o reg_ins8070.o reg_cdp1802.o $
  reg_scn2650.o reg_f3850.o reg_i8086.o reg_tms9900.o reg_tms32010.o reg_mc68000.o reg_z8000.o $
  reg_ns32000.o reg_mn1610.o $
  table_mc6809.o table_mc6800.o table_mc6805.o table_mos6502.o table_i8048.o table_i8051.o $
  table_i8080.o table_i8096.o table_z80.o table_z8.o table_tlcs90.o table_ins8060.o $
  table_ins8070.o table_cdp1802.o table_scn2650.o table_f3850.o table_i8086.o table_tms9900.o $
  table_tms32010.o table_mc68000.o table_z8000.o table_ns32000.o table_mn1610.o $
  text_common.o text_mc6809.o text_mc6800.o text_mc6805.o text_mos6502.o text_i8048.o $
  text_i8051.o text_i8080.o text_i8096.o text_z80.o text_z8.o text_tlcs90.o text_ins8060.o $
  text_ins8070.o text_cdp1802.o text_scn2650.o text_f3850.o text_i8086.o text_tms9900.o $
  text_tms32010.o text_mc68000.o text_z8000.o text_ns32000.o text_mn1610.o

build test: phony test_helpers test_bin_memory test_intel_hex test_moto_srec $
  test_asm_formatter test_dis_formatter

default test
