/*
 * Copyright 2023 Tadashi G. Takaoka
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include "dis_im6100.h"
#include "test_dis_helper.h"

using namespace libasm;
using namespace libasm::im6100;
using namespace libasm::test;

DisIm6100 dis6100;
Disassembler &disassembler(dis6100);

static void set_up() {
    disassembler.reset();
    disassembler.setOption("ignore-literal", "on");
}

static void tear_down() {
    symtab.reset();
}

// clang-format off
void test_cpu() {
    EQUALS("cpu 6100", true,   disassembler.setCpu("6100"));
    EQUALS_P("cpu 6100", "6100", disassembler.cpu_P());

    EQUALS("cpu IM6100", true,   disassembler.setCpu("IM6100"));
    EQUALS_P("cpu IM6100", "6100", disassembler.cpu_P());
}

void test_memory_reference() {
    constexpr uint16_t IA = 0400;
    ATEST(04000, AND, "0022",   00000|0022);
    ATEST(04000, AND, "I 0043", 00000|0043|IA);
    ATEST(04000, TAD, "0064",   01000|0064);
    ATEST(04000, TAD, "I 0105", 01000|0105|IA);
    ATEST(04000, ISZ, "0170",   02000|0170);
    ATEST(04000, ISZ, "I 0147", 02000|0147|IA);
    ATEST(04000, DCA, "0170",   03000|0170);
    ATEST(04000, DCA, "I 0011", 03000|0011|IA);
    ATEST(04000, JMS, "0032",   04000|0032);
    ATEST(04000, JMS, "I 0053", 04000|0053|IA);
    ATEST(04000, JMP, "0074",   05000|0074);
    ATEST(04000, JMP, "I 0115", 05000|0115|IA);

    constexpr uint16_t MP = 0200;
    ATEST(04000, AND, "4022",   00000|0022|MP);
    ATEST(04000, AND, "I 4043", 00000|0043|MP|IA);
    ATEST(04000, TAD, "4064",   01000|0064|MP);
    ATEST(04000, TAD, "I 4105", 01000|0105|MP|IA);
    ATEST(04000, ISZ, "4126",   02000|0126|MP);
    ATEST(04000, ISZ, "I 4147", 02000|0147|MP|IA);
    ATEST(04000, DCA, "4170",   03000|0170|MP);
    ATEST(04000, DCA, "I 4011", 03000|0011|MP|IA);
    ATEST(04000, JMS, "4032",   04000|0032|MP);
    ATEST(04000, JMS, "I 4053", 04000|0053|MP|IA);
    ATEST(04000, JMP, "4074",   05000|0074|MP);
    ATEST(04000, JMP, "I 4115", 05000|0115|MP|IA);

    symtab.intern(00017, "auto017");
    symtab.intern(00020, "zero020");
    symtab.intern(04017, "label4017");
    symtab.intern(04020, "label4020");

    ATEST(04000, AND, "zero020",     00000|0020);
    ATEST(04000, AND, "I auto017",   00000|0017|IA);
    ATEST(04000, AND, "I label4017", 00000|0017|MP|IA);
    ATEST(04000, AND, "label4020",   00000|0020|MP);
}

void test_group1() {
    TEST(NOP, "",            07000);
    TEST(IAC, "",            07001);
    TEST(BSW, "",            07002);
    TEST(BSW, "IAC",         07003);
    TEST(RAL, "",            07004);
    TEST(RAL, "IAC",         07005);
    TEST(RTL, "",            07006);
    TEST(RTL, "IAC",         07007);
    TEST(RAR, "",            07010);
    TEST(RAR, "IAC",         07011);
    TEST(RTR, "",            07012);
    TEST(RTR, "IAC",         07013);
    ERUI(___, "",            07014);
    ERII(___, "",            07015);
    ERUI(___, "",            07016);
    ERII(___, "",            07017);
    TEST(CML, "",            07020);
    TEST(CML, "IAC",         07021);
    TEST(CML, "BSW",         07022);
    TEST(CML, "BSW IAC",     07023);
    TEST(CML, "RAL",         07024);
    TEST(CML, "RAL IAC",     07025);
    TEST(CML, "RTL",         07026);
    TEST(CML, "RTL IAC",     07027);
    TEST(CML, "RAR",         07030);
    TEST(CML, "RAR IAC",     07031);
    TEST(CML, "RTR",         07032);
    TEST(CML, "RTR IAC",     07033);
    ERII(___, "",            07034);
    ERII(___, "",            07035);
    ERII(___, "",            07036);
    ERII(___, "",            07037);
    TEST(CMA, "",            07040);
    TEST(CIA, "",            07041);
    TEST(CMA, "BSW",         07042);
    TEST(CIA, "BSW",         07043);
    TEST(CMA, "RAL",         07044);
    TEST(CIA, "RAL",         07045);
    TEST(CMA, "RTL",         07046);
    TEST(CIA, "RTL",         07047);
    TEST(CMA, "RAR",         07050);
    TEST(CIA, "RAR",         07051);
    TEST(CMA, "RTR",         07052);
    TEST(CIA, "RTR",         07053);
    ERII(___, "",            07054);
    ERII(___, "",            07055);       
    ERII(___, "",            07056);
    ERII(___, "",            07057);
    TEST(CMA, "CML",         07060);
    TEST(CIA, "CML",         07061);
    TEST(CMA, "CML BSW",     07062);
    TEST(CIA, "CML BSW",     07063);
    TEST(CMA, "CML RAL",     07064);
    TEST(CIA, "CML RAL",     07065);
    TEST(CMA, "CML RTL",     07066);
    TEST(CIA, "CML RTL",     07067);
    TEST(CMA, "CML RAR",     07070);
    TEST(CIA, "CML RAR",     07071);
    TEST(CMA, "CML RTR",     07072);
    TEST(CIA, "CML RTR",     07073);
    ERII(___, "",            07074);
    ERII(___, "",            07075);
    ERII(___, "",            07076);
    ERII(___, "",            07077);
    TEST(CLL, "",            07100);
    TEST(CLL, "IAC",         07101);
    TEST(CLL, "BSW",         07102);
    TEST(CLL, "BSW IAC",     07103);
    TEST(CLL, "RAL",         07104);
    TEST(CLL, "RAL IAC",     07105);
    TEST(CLL, "RTL",         07106);
    TEST(CLL, "RTL IAC",     07107);
    TEST(CLL, "RAR",         07110);
    TEST(CLL, "RAR IAC",     07111);
    TEST(CLL, "RTR",         07112);
    TEST(CLL, "RTR IAC",     07113);
    ERII(___, "",            07114);
    ERII(___, "",            07115);
    ERII(___, "",            07116);
    ERII(___, "",            07117);
    TEST(STL, "",            07120);
    TEST(STL, "IAC",         07121);
    TEST(STL, "BSW",         07122);
    TEST(STL, "BSW IAC",     07123);
    TEST(STL, "RAL",         07124);
    TEST(STL, "RAL IAC",     07125);
    TEST(STL, "RTL",         07126);
    TEST(STL, "RTL IAC",     07127);
    TEST(STL, "RAR",         07130);
    TEST(STL, "RAR IAC",     07131);
    TEST(STL, "RTR",         07132);
    TEST(STL, "RTR IAC",     07133);
    ERII(___, "",            07134);
    ERII(___, "",            07135);
    ERII(___, "",            07136);
    ERII(___, "",            07137);
    TEST(CLL, "CMA",         07140);
    TEST(CLL, "CIA",         07141);
    TEST(CLL, "CMA BSW",     07142);
    TEST(CLL, "CIA BSW",     07143);
    TEST(CLL, "CMA RAL",     07144);
    TEST(CLL, "CIA RAL",     07145);
    TEST(CLL, "CMA RTL",     07146);
    TEST(CLL, "CIA RTL",     07147);
    TEST(CLL, "CMA RAR",     07150);
    TEST(CLL, "CIA RAR",     07151);
    TEST(CLL, "CMA RTR",     07152);
    TEST(CLL, "CIA RTR",     07153);
    ERII(___, "",            07154);
    ERII(___, "",            07155);
    ERII(___, "",            07156);
    ERII(___, "",            07157);
    TEST(STL, "CMA",         07160);
    TEST(STL, "CIA",         07161);
    TEST(STL, "CMA BSW",     07162);
    TEST(STL, "CIA BSW",     07163);
    TEST(STL, "CMA RAL",     07164);
    TEST(STL, "CIA RAL",     07165);
    TEST(STL, "CMA RTL",     07166);
    TEST(STL, "CIA RTL",     07167);
    TEST(STL, "CMA RAR",     07170);
    TEST(STL, "CIA RAR",     07171);
    TEST(STL, "CMA RTR",     07172);
    TEST(STL, "CIA RTR",     07173);
    ERII(___, "",            07174);
    ERII(___, "",            07175);
    ERII(___, "",            07176);
    ERII(___, "",            07177);
    TEST(CLA, "",            07200);
    TEST(CLA, "IAC",         07201);
    TEST(CLA, "BSW",         07202);
    TEST(CLA, "BSW IAC",     07203);
    TEST(GLK, "",            07204);
    TEST(GLK, "IAC",         07205);
    TEST(CLA, "RTL",         07206);
    TEST(CLA, "RTL IAC",     07207);
    TEST(CLA, "RAR",         07210);
    TEST(CLA, "RAR IAC",     07211);
    TEST(CLA, "RTR",         07212);
    TEST(CLA, "RTR IAC",     07213);
    ERII(___, "",            07214);
    ERII(___, "",            07215);
    ERII(___, "",            07216);
    ERII(___, "",            07217);
    TEST(CLA, "CML",         07220);
    TEST(CLA, "CML IAC",     07221);
    TEST(CLA, "CML BSW",     07222);
    TEST(CLA, "CML BSW IAC", 07223);
    TEST(GLK, "CML",         07224);
    TEST(GLK, "CML IAC",     07225);
    TEST(CLA, "CML RTL",     07226);
    TEST(CLA, "CML RTL IAC", 07227);
    TEST(CLA, "CML RAR",     07230);
    TEST(CLA, "CML RAR IAC", 07231);
    TEST(CLA, "CML RTR",     07232);
    TEST(CLA, "CML RTR IAC", 07233);
    ERII(___, "",            07234);
    ERII(___, "",            07235);
    ERII(___, "",            07236);
    ERII(___, "",            07237);
    TEST(STA, "",            07240);
    TEST(STA, "IAC",         07241);
    TEST(STA, "BSW",         07242);
    TEST(STA, "BSW IAC",     07243);
    TEST(GLK, "CMA",         07244);
    TEST(GLK, "CIA",         07245);
    TEST(STA, "RTL",         07246);
    TEST(STA, "RTL IAC",     07247);
    TEST(STA, "RAR",         07250);
    TEST(STA, "RAR IAC",     07251);
    TEST(STA, "RTR",         07252);
    TEST(STA, "RTR IAC",     07253);
    ERII(___, "",            07254);
    ERII(___, "",            07255);
    ERII(___, "",            07256);
    ERII(___, "",            07257);
    TEST(STA, "CML",         07260);
    TEST(STA, "CML IAC",     07261);
    TEST(STA, "CML BSW",     07262);
    TEST(STA, "CML BSW IAC", 07263);
    TEST(GLK, "CMA CML",     07264);
    TEST(GLK, "CIA CML",     07265);
    TEST(STA, "CML RTL",     07266);
    TEST(STA, "CML RTL IAC", 07267);
    TEST(STA, "CML RAR",     07270);
    TEST(STA, "CML RAR IAC", 07271);
    TEST(STA, "CML RTR",     07272);
    TEST(STA, "CML RTR IAC", 07273);
    ERII(___, "",            07274);
    ERII(___, "",            07275);
    ERII(___, "",            07276);
    ERII(___, "",            07277);
    TEST(CLA, "CLL",         07300);
    TEST(CLA, "CLL IAC",     07301);
    TEST(CLA, "CLL BSW",     07302);
    TEST(CLA, "CLL BSW IAC", 07303);
    TEST(GLK, "CLL",         07304);
    TEST(GLK, "CLL IAC",     07305);
    TEST(CLA, "CLL RTL",     07306);
    TEST(CLA, "CLL RTL IAC", 07307);
    TEST(CLA, "CLL RAR",     07310);
    TEST(CLA, "CLL RAR IAC", 07311);
    TEST(CLA, "CLL RTR",     07312);
    TEST(CLA, "CLL RTR IAC", 07313);
    ERII(___, "",            07314);
    ERII(___, "",            07315);
    ERII(___, "",            07316);
    ERII(___, "",            07317);
    TEST(STL, "CLA",         07320);
    TEST(STL, "CLA IAC",     07321);
    TEST(STL, "CLA BSW",     07322);
    TEST(STL, "CLA BSW IAC", 07323);
    TEST(GLK, "STL",         07324);
    TEST(GLK, "STL IAC",     07325);
    TEST(STL, "CLA RTL",     07326);
    TEST(STL, "CLA RTL IAC", 07327);
    TEST(STL, "CLA RAR",     07330);
    TEST(STL, "CLA RAR IAC", 07331);
    TEST(STL, "CLA RTR",     07332);
    TEST(STL, "CLA RTR IAC", 07333);
    ERII(___, "",            07334);
    ERII(___, "",            07335);
    ERII(___, "",            07336);
    ERII(___, "",            07337);
    TEST(STA, "CLL",         07340);
    TEST(STA, "CLL IAC",     07341);
    TEST(STA, "CLL BSW",     07342);
    TEST(STA, "CLL BSW IAC", 07343);
    TEST(GLK, "CLL CMA",     07344);
    TEST(GLK, "CLL CIA",     07345);
    TEST(STA, "CLL RTL",     07346);
    TEST(STA, "CLL RTL IAC", 07347);
    TEST(STA, "CLL RAR",     07350);
    TEST(STA, "CLL RAR IAC", 07351);
    TEST(STA, "CLL RTR",     07352);
    TEST(STA, "CLL RTR IAC", 07353);
    ERII(___, "",            07354);
    ERII(___, "",            07355);
    ERII(___, "",            07356);
    ERII(___, "",            07357);
    TEST(STL, "STA",         07360);
    TEST(STL, "STA IAC",     07361);
    TEST(STL, "STA BSW",     07362);
    TEST(STL, "STA BSW IAC", 07363);
    TEST(GLK, "STL CMA",     07364);
    TEST(GLK, "STL CIA",     07365);
    TEST(STL, "STA RTL",     07366);
    TEST(STL, "STA RTL IAC", 07367);
    TEST(STL, "STA RAR",     07370);
    TEST(STL, "STA RAR IAC", 07371);
    TEST(STL, "STA RTR",     07372);
    TEST(STL, "STA RTR IAC", 07373);
    ERII(___, "",            07374);
    ERII(___, "",            07375);
    ERII(___, "",            07376);
    ERII(___, "",            07377);
}

void test_group2() {
    TEST(NOP, "",            07400);
    TEST(SKP, "",            07410);
    TEST(SNL, "",            07420);
    TEST(SZL, "",            07430);
    TEST(SZA, "",            07440);
    TEST(SNA, "",            07450);
    TEST(SZA, "SNL",         07460);
    TEST(SNA, "SZL",         07470);
    TEST(SMA, "",            07500);
    TEST(SPA, "",            07510);
    TEST(SMA, "SNL",         07520);
    TEST(SPA, "SZL",         07530);
    TEST(SMA, "SZA",         07540);
    TEST(SPA, "SNA",         07550);
    TEST(SMA, "SZA SNL",     07560);
    TEST(SPA, "SNA SZL",     07570);
    TEST(CLA, "",            07600);
    TEST(SKP, "CLA",         07610);
    TEST(SNL, "CLA",         07620);
    TEST(SZL, "CLA",         07630);
    TEST(SZA, "CLA",         07640);
    TEST(SNA, "CLA",         07650);
    TEST(SZA, "SNL CLA",     07660);
    TEST(SNA, "SZL CLA",     07670);
    TEST(SMA, "CLA",         07700);
    TEST(SPA, "CLA",         07710);
    TEST(SMA, "SNL CLA",     07720);
    TEST(SPA, "SZL CLA",     07730);
    TEST(SMA, "SZA CLA",     07740);
    TEST(SPA, "SNA CLA",     07750);
    TEST(SMA, "SZA SNL CLA", 07760);
    TEST(SPA, "SNA SZL CLA", 07770);

    TEST(HLT, "",                07402);
    TEST(SKP, "HLT",             07412);
    TEST(SNL, "HLT",             07422);
    TEST(SZL, "HLT",             07432);
    TEST(SZA, "HLT",             07442);
    TEST(SNA, "HLT",             07452);
    TEST(SZA, "SNL HLT",         07462);
    TEST(SNA, "SZL HLT",         07472);
    TEST(SMA, "HLT",             07502);
    TEST(SPA, "HLT",             07512);
    TEST(SMA, "SNL HLT",         07522);
    TEST(SPA, "SZL HLT",         07532);
    TEST(SMA, "SZA HLT",         07542);
    TEST(SPA, "SNA HLT",         07552);
    TEST(SMA, "SZA SNL HLT",     07562);
    TEST(SPA, "SNA SZL HLT",     07572);
    TEST(CLA, "HLT",             07602);
    TEST(SKP, "CLA HLT",         07612);
    TEST(SNL, "CLA HLT",         07622);
    TEST(SZL, "CLA HLT",         07632);
    TEST(SZA, "CLA HLT",         07642);
    TEST(SNA, "CLA HLT",         07652);
    TEST(SZA, "SNL CLA HLT",     07662);
    TEST(SNA, "SZL CLA HLT",     07672);
    TEST(SMA, "CLA HLT",         07702);
    TEST(SPA, "CLA HLT",         07712);
    TEST(SMA, "SNL CLA HLT",     07722);
    TEST(SPA, "SZL CLA HLT",     07732);
    TEST(SMA, "SZA CLA HLT",     07742);
    TEST(SPA, "SNA CLA HLT",     07752);
    TEST(SMA, "SZA SNL CLA HLT", 07762);
    TEST(SPA, "SNA SZL CLA HLT", 07772);

    TEST(OSR, "",            07404);
    TEST(SKP, "OSR",         07414);
    TEST(SNL, "OSR",         07424);
    TEST(SZL, "OSR",         07434);
    TEST(SZA, "OSR",         07444);
    TEST(SNA, "OSR",         07454);
    TEST(SZA, "SNL OSR",     07464);
    TEST(SNA, "SZL OSR",     07474);
    TEST(SMA, "OSR",         07504);
    TEST(SPA, "OSR",         07514);
    TEST(SMA, "SNL OSR",     07524);
    TEST(SPA, "SZL OSR",     07534);
    TEST(SMA, "SZA OSR",     07544);
    TEST(SPA, "SNA OSR",     07554);
    TEST(SMA, "SZA SNL OSR", 07564);
    TEST(SPA, "SNA SZL OSR", 07574);
    TEST(LAS, "",            07604);
    TEST(SKP, "LAS",         07614);
    TEST(SNL, "LAS",         07624);
    TEST(SZL, "LAS",         07634);
    TEST(SZA, "LAS",         07644);
    TEST(SNA, "LAS",         07654);
    TEST(SZA, "SNL LAS",     07664);
    TEST(SNA, "SZL LAS",     07674);
    TEST(SMA, "LAS",         07704);
    TEST(SPA, "LAS",         07714);
    TEST(SMA, "SNL LAS",     07724);
    TEST(SPA, "SZL LAS",     07734);
    TEST(SMA, "SZA LAS",     07744);
    TEST(SPA, "SNA LAS",     07754);
    TEST(SMA, "SZA SNL LAS", 07764);
    TEST(SPA, "SNA SZL LAS", 07774);

    TEST(OSR, "HLT",             07406);
    TEST(SKP, "OSR HLT",         07416);
    TEST(SNL, "OSR HLT",         07426);
    TEST(SZL, "OSR HLT",         07436);
    TEST(SZA, "OSR HLT",         07446);
    TEST(SNA, "OSR HLT",         07456);
    TEST(SZA, "SNL OSR HLT",     07466);
    TEST(SNA, "SZL OSR HLT",     07476);
    TEST(SMA, "OSR HLT",         07506);
    TEST(SPA, "OSR HLT",         07516);
    TEST(SMA, "SNL OSR HLT",     07526);
    TEST(SPA, "SZL OSR HLT",     07536);
    TEST(SMA, "SZA OSR HLT",     07546);
    TEST(SPA, "SNA OSR HLT",     07556);
    TEST(SMA, "SZA SNL OSR HLT", 07566);
    TEST(SPA, "SNA SZL OSR HLT", 07576);
    TEST(LAS, "HLT",             07606);
    TEST(SKP, "LAS HLT",         07616);
    TEST(SNL, "LAS HLT",         07626);
    TEST(SZL, "LAS HLT",         07636);
    TEST(SZA, "LAS HLT",         07646);
    TEST(SNA, "LAS HLT",         07656);
    TEST(SZA, "SNL LAS HLT",     07666);
    TEST(SNA, "SZL LAS HLT",     07676);
    TEST(SMA, "LAS HLT",         07706);
    TEST(SPA, "LAS HLT",         07716);
    TEST(SMA, "SNL LAS HLT",     07726);
    TEST(SPA, "SZL LAS HLT",     07736);
    TEST(SMA, "SZA LAS HLT",     07746);
    TEST(SPA, "SNA LAS HLT",     07756);
    TEST(SMA, "SZA SNL LAS HLT", 07766);
    TEST(SPA, "SNA SZL LAS HLT", 07776);
}

void test_group3() {
    TEST(NOP, "",    07401);
    TEST(MQL, "",    07421);
    TEST(MQA, "",    07501);
    TEST(SWP, "",    07521);
    TEST(CLA, "",    07601);
    TEST(CAM, "",    07621);
    TEST(ACL, "",    07701);
    TEST(CLA, "SWP", 07721);
}

void test_internal_control() {
    TEST(ION, "", 06001);
    TEST(IOF, "", 06002);
    TEST(RTF, "", 06005);
    TEST(SGT, "", 06006);
    TEST(CAF, "", 06007);
}

void test_main_memory() {
    TEST(SKON, "", 06000);
    TEST(SRQ,  "", 06003);
    TEST(GTF,  "", 06004);
}

void test_io_transfer() {
    TEST(IOT, "01 0", 06010);
    TEST(IOT, "01 7", 06017);
    TEST(IOT, "77 0", 06770);
    TEST(IOT, "77 7", 06777);

    symtab.intern(077, "dev77");
    symtab.intern(1, "cmd1");
    symtab.intern(6, "cmd6");

    TEST(IOT, "dev77 cmd1", 06771);
    TEST(IOT, "dev77 cmd6", 06776);
}

void test_literal() {
    disassembler.setOption("ignore-literal", "off");

    // group 1
    LITR(7014, 07014);
    LITR(7015, 07015);
    LITR(7016, 07016);
    LITR(7017, 07017);
    LITR(7034, 07034);
    LITR(7035, 07035);
    LITR(7036, 07036);
    LITR(7037, 07037);
    LITR(7054, 07054);
    LITR(7055, 07055);
    LITR(7056, 07056);
    LITR(7057, 07057);
    LITR(7074, 07074);
    LITR(7075, 07075);
    LITR(7076, 07076);
    LITR(7077, 07077);
    LITR(7114, 07114);
    LITR(7115, 07115);
    LITR(7116, 07116);
    LITR(7117, 07117);
    LITR(7134, 07134);
    LITR(7135, 07135);
    LITR(7136, 07136);
    LITR(7137, 07137);
    LITR(7154, 07154);
    LITR(7155, 07155);
    LITR(7156, 07156);
    LITR(7157, 07157);
    LITR(7174, 07174);
    LITR(7175, 07175);
    LITR(7176, 07176);
    LITR(7177, 07177);
    LITR(7214, 07214);
    LITR(7215, 07215);
    LITR(7216, 07216);
    LITR(7217, 07217);
    LITR(7234, 07234);
    LITR(7235, 07235);
    LITR(7236, 07236);
    LITR(7237, 07237);
    LITR(7254, 07254);
    LITR(7255, 07255);
    LITR(7256, 07256);
    LITR(7257, 07257);
    LITR(7274, 07274);
    LITR(7275, 07275);
    LITR(7276, 07276);
    LITR(7277, 07277);
    LITR(7314, 07314);
    LITR(7315, 07315);
    LITR(7316, 07316);
    LITR(7317, 07317);
    LITR(7334, 07334);
    LITR(7335, 07335);
    LITR(7336, 07336);
    LITR(7337, 07337);
    LITR(7354, 07354);
    LITR(7355, 07355);
    LITR(7356, 07356);
    LITR(7357, 07357);
    LITR(7374, 07374);
    LITR(7375, 07375);
    LITR(7376, 07376);
    LITR(7377, 07377);

    // group 3
    LITR(7403, 07403);
    LITR(7405, 07405);
    LITR(7407, 07407);
    LITR(7411, 07411);
    LITR(7413, 07413);
    LITR(7415, 07415);
    LITR(7417, 07417);
    LITR(7423, 07423);
    LITR(7425, 07425);
    LITR(7427, 07427);
    LITR(7431, 07431);
    LITR(7433, 07433);
    LITR(7435, 07435);
    LITR(7437, 07437);
    LITR(7441, 07441);
    LITR(7443, 07443);
    LITR(7445, 07445);
    LITR(7447, 07447);
    LITR(7451, 07451);
    LITR(7453, 07453);
    LITR(7455, 07455);
    LITR(7457, 07457);
    LITR(7461, 07461);
    LITR(7463, 07463);
    LITR(7465, 07465);
    LITR(7467, 07467);
    LITR(7471, 07471);
    LITR(7473, 07473);
    LITR(7475, 07475);
    LITR(7477, 07477);
    LITR(7503, 07503);
    LITR(7505, 07505);
    LITR(7507, 07507);
    LITR(7511, 07511);
    LITR(7513, 07513);
    LITR(7515, 07515);
    LITR(7517, 07517);
    LITR(7523, 07523);
    LITR(7525, 07525);
    LITR(7527, 07527);
    LITR(7531, 07531);
    LITR(7533, 07533);
    LITR(7535, 07535);
    LITR(7537, 07537);
    LITR(7541, 07541);
    LITR(7543, 07543);
    LITR(7545, 07545);
    LITR(7547, 07547);
    LITR(7551, 07551);
    LITR(7553, 07553);
    LITR(7555, 07555);
    LITR(7557, 07557);
    LITR(7561, 07561);
    LITR(7563, 07563);
    LITR(7565, 07565);
    LITR(7567, 07567);
    LITR(7571, 07571);
    LITR(7573, 07573);
    LITR(7575, 07575);
    LITR(7577, 07577);
    LITR(7603, 07603);
    LITR(7605, 07605);
    LITR(7607, 07607);
    LITR(7611, 07611);
    LITR(7613, 07613);
    LITR(7615, 07615);
    LITR(7617, 07617);
    LITR(7623, 07623);
    LITR(7625, 07625);
    LITR(7627, 07627);
    LITR(7631, 07631);
    LITR(7633, 07633);
    LITR(7635, 07635);
    LITR(7637, 07637);
    LITR(7641, 07641);
    LITR(7643, 07643);
    LITR(7645, 07645);
    LITR(7647, 07647);
    LITR(7651, 07651);
    LITR(7653, 07653);
    LITR(7655, 07655);
    LITR(7657, 07657);
    LITR(7661, 07661);
    LITR(7663, 07663);
    LITR(7665, 07665);
    LITR(7667, 07667);
    LITR(7671, 07671);
    LITR(7673, 07673);
    LITR(7675, 07675);
    LITR(7677, 07677);
    LITR(7703, 07703);
    LITR(7705, 07705);
    LITR(7707, 07707);
    LITR(7711, 07711);
    LITR(7713, 07713);
    LITR(7715, 07715);
    LITR(7717, 07717);
    LITR(7723, 07723);
    LITR(7725, 07725);
    LITR(7727, 07727);
    LITR(7731, 07731);
    LITR(7733, 07733);
    LITR(7735, 07735);
    LITR(7737, 07737);
    LITR(7741, 07741);
    LITR(7743, 07743);
    LITR(7745, 07745);
    LITR(7747, 07747);
    LITR(7751, 07751);
    LITR(7753, 07753);
    LITR(7755, 07755);
    LITR(7757, 07757);
    LITR(7761, 07761);
    LITR(7763, 07763);
    LITR(7765, 07765);
    LITR(7767, 07767);
    LITR(7771, 07771);
    LITR(7773, 07773);
    LITR(7775, 07775);
    LITR(7777, 07777);
}

void test_illegal() {
    // group 3
    ERII(___, "", 07403);
    ERII(___, "", 07405);
    ERII(___, "", 07407);
    ERII(___, "", 07411);
    ERII(___, "", 07413);
    ERII(___, "", 07415);
    ERII(___, "", 07417);
    ERII(___, "", 07423);
    ERII(___, "", 07425);
    ERII(___, "", 07427);
    ERII(___, "", 07431);
    ERII(___, "", 07433);
    ERII(___, "", 07435);
    ERII(___, "", 07437);
    ERII(___, "", 07441);
    ERII(___, "", 07443);
    ERII(___, "", 07445);
    ERII(___, "", 07447);
    ERII(___, "", 07451);
    ERII(___, "", 07453);
    ERII(___, "", 07455);
    ERII(___, "", 07457);
    ERII(___, "", 07461);
    ERII(___, "", 07463);
    ERII(___, "", 07465);
    ERII(___, "", 07467);
    ERII(___, "", 07471);
    ERII(___, "", 07473);
    ERII(___, "", 07475);
    ERII(___, "", 07477);
    ERII(___, "", 07503);
    ERII(___, "", 07505);
    ERII(___, "", 07507);
    ERII(___, "", 07511);
    ERII(___, "", 07513);
    ERII(___, "", 07515);
    ERII(___, "", 07517);
    ERII(___, "", 07523);
    ERII(___, "", 07525);
    ERII(___, "", 07527);
    ERII(___, "", 07531);
    ERII(___, "", 07533);
    ERII(___, "", 07535);
    ERII(___, "", 07537);
    ERII(___, "", 07541);
    ERII(___, "", 07543);
    ERII(___, "", 07545);
    ERII(___, "", 07547);
    ERII(___, "", 07551);
    ERII(___, "", 07553);
    ERII(___, "", 07555);
    ERII(___, "", 07557);
    ERII(___, "", 07561);
    ERII(___, "", 07563);
    ERII(___, "", 07565);
    ERII(___, "", 07567);
    ERII(___, "", 07571);
    ERII(___, "", 07573);
    ERII(___, "", 07575);
    ERII(___, "", 07577);
    ERII(___, "", 07603);
    ERII(___, "", 07605);
    ERII(___, "", 07607);
    ERII(___, "", 07611);
    ERII(___, "", 07613);
    ERII(___, "", 07615);
    ERII(___, "", 07617);
    ERII(___, "", 07623);
    ERII(___, "", 07625);
    ERII(___, "", 07627);
    ERII(___, "", 07631);
    ERII(___, "", 07633);
    ERII(___, "", 07635);
    ERII(___, "", 07637);
    ERII(___, "", 07641);
    ERII(___, "", 07643);
    ERII(___, "", 07645);
    ERII(___, "", 07647);
    ERII(___, "", 07651);
    ERII(___, "", 07653);
    ERII(___, "", 07655);
    ERII(___, "", 07657);
    ERII(___, "", 07661);
    ERII(___, "", 07663);
    ERII(___, "", 07665);
    ERII(___, "", 07667);
    ERII(___, "", 07671);
    ERII(___, "", 07673);
    ERII(___, "", 07675);
    ERII(___, "", 07677);
    ERII(___, "", 07703);
    ERII(___, "", 07705);
    ERII(___, "", 07707);
    ERII(___, "", 07711);
    ERII(___, "", 07713);
    ERII(___, "", 07715);
    ERII(___, "", 07717);
    ERII(___, "", 07723);
    ERII(___, "", 07725);
    ERII(___, "", 07727);
    ERII(___, "", 07731);
    ERII(___, "", 07733);
    ERII(___, "", 07735);
    ERII(___, "", 07737);
    ERII(___, "", 07741);
    ERII(___, "", 07743);
    ERII(___, "", 07745);
    ERII(___, "", 07747);
    ERII(___, "", 07751);
    ERII(___, "", 07753);
    ERII(___, "", 07755);
    ERII(___, "", 07757);
    ERII(___, "", 07761);
    ERII(___, "", 07763);
    ERII(___, "", 07765);
    ERII(___, "", 07767);
    ERII(___, "", 07771);
    ERII(___, "", 07773);
    ERII(___, "", 07775);
    ERII(___, "", 07777);
}

// clang-format on

void run_tests(const char *cpu) {
    disassembler.setCpu(cpu);
    RUN_TEST(test_memory_reference);
    RUN_TEST(test_group1);
    RUN_TEST(test_group2);
    RUN_TEST(test_group3);
    RUN_TEST(test_internal_control);
    RUN_TEST(test_main_memory);
    RUN_TEST(test_io_transfer);
    RUN_TEST(test_literal);
    RUN_TEST(test_illegal);
}

// Local Variables:
// mode: c++
// c-basic-offset: 4
// tab-width: 4
// End:
// vim: set ft=cpp et ts=4 sw=4:
